<template>
  <nav
    class="pb-1 pt-2 sm:py-0 sm:mx-4 border-t sm:border-t-0 sm:border-r sm:border-solid border-gray sm:min-h-screen fixed bottom-0 bg-white"
    id="navbar"
  >
    <router-link :to="`/`" class="hidden sm:flex mt-7 mb-16"
      ><img src="../assets/logo.svg" alt="inspectrum clinic" class="mr-3" /><img
        v-if="!menuWrapp"
        src="../assets/logo-text.svg"
        alt="inspectrum clinic"
    /></router-link>
    <ul class="flex sm:block sm:w-auto w-screen">
      <li
        v-for="(menuItem, idx) in windowWidth >= 640
          ? menuItems
          : filterMobileMenu"
        :key="idx"
        class="sm:w-auto w-1/5"
      >
        <router-link
          :to="menuItem.route"
          :class="`flex sm:py-4 sm:ps-4 ${
            menuWrapp ? 'pe-4' : 'sm:pe-14 '
          } rounded-bl-3xl rounded-tl-3xl sm:flex-row flex-col items-center sm:items-start`"
        >
          <svg
            :width="menuItem.width"
            :height="menuItem.height"
            :viewBox="`0 0 24 24`"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
            :class="`mt-px ${menuWrapp ? '' : 'sm:mr-3'} sm:mb-0 mb-1`"
          >
            <path fill-rule="evenodd" clip-rule="evenodd" :d="menuItem.path" />
          </svg>
          <p v-if="!menuWrapp || windowWidth < 640" class="text-darkGray">
            {{ menuItem.name }}
          </p></router-link
        >
      </li>
      <li
        @click="moreMenuMobileshow = !moreMenuMobileshow"
        v-if="windowWidth < 640"
        class="w-1/5 flex justify-center"
      >
        <button>
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M12 24C18.6274 24 24 18.6274 24 12C24 5.37259 18.6274 0 12 0C5.37259 0 0 5.37259 0 12C0 18.6274 5.37259 24 12 24ZM8 12C8 13.1046 7.10456 14 6 14C4.89544 14 4 13.1046 4 12C4 10.8954 4.89544 10 6 10C7.10456 10 8 10.8954 8 12ZM12 14C13.1046 14 14 13.1046 14 12C14 10.8954 13.1046 10 12 10C10.8954 10 10 10.8954 10 12C10 13.1046 10.8954 14 12 14ZM20 12C20 13.1046 19.1046 14 18 14C16.8954 14 16 13.1046 16 12C16 10.8954 16.8954 10 18 10C19.1046 10 20 10.8954 20 12Z"
              fill="#8F9BB3"
            />
          </svg>
          <p class="text-darkGray">Ещё</p>
        </button>
      </li>
    </ul>
    <button
      @click="toggleMenu()"
      class="hidden sm:block border border-solid border-gray rounded-3xl py-4 px-1 absolute -right-2"
      id="menuWrap"
    >
      <svg
        width="7"
        height="10"
        viewBox="0 0 7 10"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          :d="
            !menuWrapp
              ? `M5.42969 9L1.42969 5L5.42969 1`
              : 'M1.42969 9L5.42969 5L1.42969 1'
          "
          stroke="#8F9BB3"
          stroke-width="1.16667"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
      </svg>
    </button>
    <div
      v-if="moreMenuMobileshow"
      v-click-outside="onClickOutside"
      class="absolute -top-48 right-5"
    >
      <ul>
        <li
          @click="moreMenuMobileshow = false"
          v-for="(menuItem, idx) in filterMoreMenu"
          :key="idx"
        >
          <router-link
            :to="menuItem.route"
            :class="`flex flex-col items-center mb-4`"
          >
            <svg
              :width="menuItem.width"
              :height="menuItem.height"
              :viewBox="`0 0 24 24`"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
              :class="`mt-px mb-1`"
            >
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                :d="menuItem.path"
              />
            </svg>
            <p class="text-darkGray">
              {{ menuItem.name }}
            </p></router-link
          >
        </li>
      </ul>
    </div>
  </nav>
</template>

<script>
import { getters,mutations } from "../store/index.js";
import vClickOutside from "click-outside-vue3";
export default {
  name: "Navbar-component",
  data: () => ({
    moreMenuMobileshow: false,
    windowWidth: window.innerWidth,
    menuItems: [
      {
        name: "Главная",
        path: "M10.7878 1.21694C11.4573 0.547478 12.5427 0.547478 13.2122 1.21694L23.4979 11.5027C24.1673 12.1721 24.1673 13.2576 23.4979 13.927C22.8285 14.5965 21.743 14.5965 21.0735 13.927L20.5714 13.4249V21.2863C20.5714 22.2331 19.8039 23.0006 18.8571 23.0006H16C15.4477 23.0006 15 22.5528 15 22.0006V15.0006C15 14.4483 14.5523 14.0006 14 14.0006L10 14.0006C9.44771 14.0006 9 14.4483 9 15.0006V22.0006C9 22.5528 8.55228 23.0006 8 23.0006L5.14286 23.0006C4.19609 23.0006 3.42857 22.2331 3.42857 21.2863V13.4249L2.92647 13.927C2.25699 14.5965 1.17157 14.5965 0.502102 13.927C-0.167367 13.2576 -0.167367 12.1721 0.502102 11.5027L10.7878 1.21694Z",
        width: "24",
        height: "23",
        route: "/",
      },
      {
        name: "Каталог",
        path: "M5.71596 1.71429C5.71596 1.25963 5.89657 0.823594 6.21806 0.502103C6.53955 0.180612 6.97559 0 7.43025 0L12.5731 0C13.0278 0 13.4638 0.180612 13.7853 0.502103C14.1068 0.823594 14.2874 1.25963 14.2874 1.71429V2.57143C14.2874 3.02609 14.1068 3.46212 13.7853 3.78361C13.4638 4.1051 13.0278 4.28571 12.5731 4.28571H7.43025C7.20512 4.28571 6.9822 4.24137 6.77422 4.15522C6.56623 4.06907 6.37725 3.9428 6.21806 3.78361C6.05888 3.62443 5.9326 3.43544 5.84645 3.22746C5.7603 3.01947 5.71596 2.79655 5.71596 2.57143V1.71429ZM16.4302 1.71429H17.2874C17.9694 1.71429 18.6234 1.9852 19.1057 2.46744C19.5879 2.94968 19.8588 3.60373 19.8588 4.28571V21.4286C19.8588 21.7663 19.7923 22.1006 19.6631 22.4126C19.5339 22.7246 19.3444 23.0081 19.1057 23.2468C18.8669 23.4856 18.5834 23.675 18.2714 23.8043C17.9595 23.9335 17.6251 24 17.2874 24H2.71596C2.03397 24 1.37992 23.7291 0.897685 23.2468C0.415449 22.7646 0.144531 22.1106 0.144531 21.4286V4.28571C0.144531 3.94803 0.211043 3.61365 0.34027 3.30167C0.469496 2.98969 0.658906 2.70622 0.897685 2.46744C1.13646 2.22866 1.41994 2.03925 1.73192 1.91002C2.0439 1.7808 2.37828 1.71429 2.71596 1.71429H3.5731V2.57143C3.5731 3.59441 3.97948 4.57549 4.70283 5.29884C5.061 5.65701 5.48621 5.94112 5.95418 6.13496C6.42215 6.3288 6.92372 6.42857 7.43025 6.42857H12.5731C13.0796 6.42857 13.5812 6.3288 14.0492 6.13496C14.5171 5.94112 14.9423 5.65701 15.3005 5.29884C15.6587 4.94067 15.9428 4.51546 16.1366 4.04749C16.3305 3.57952 16.4302 3.07796 16.4302 2.57143V1.71429ZM8.23596 10.1966C8.23596 9.82457 8.53767 9.52457 8.90967 9.52457H11.0954C11.4657 9.52457 11.7674 9.82457 11.7674 10.1966V12.8709H14.4417C14.8137 12.8709 15.1137 13.1726 15.1137 13.5446V15.7303C15.1137 15.9085 15.0429 16.0794 14.9169 16.2055C14.7908 16.3315 14.6199 16.4023 14.4417 16.4023H11.7674V19.0766C11.7676 19.165 11.7504 19.2525 11.7167 19.3343C11.6831 19.416 11.6336 19.4903 11.5712 19.5529C11.5087 19.6154 11.4346 19.6651 11.3529 19.699C11.2713 19.7328 11.1838 19.7503 11.0954 19.7503H8.90796C8.81957 19.7503 8.73204 19.7328 8.6504 19.699C8.56876 19.6651 8.4946 19.6154 8.43218 19.5529C8.36975 19.4903 8.32029 19.416 8.28662 19.3343C8.25295 19.2525 8.23573 19.165 8.23596 19.0766V16.4023H5.56167C5.38345 16.4023 5.21252 16.3315 5.0865 16.2055C4.96047 16.0794 4.88967 15.9085 4.88967 15.7303V13.5429C4.88967 13.1709 5.18967 12.8691 5.56167 12.8691H8.23596V10.1949V10.1966Z",
        width: "20",
        height: "24",
        route: "/catalog",
      },
      {
        name: "Заказы",
        path: "M13.5536 1.62472C13.5536 1.15134 13.9373 0.767578 14.4107 0.767578H17.1963C17.6698 0.767578 18.0535 1.15134 18.0535 1.62472V4.03549H20.4643C20.9376 4.03549 21.3214 4.41923 21.3214 4.89263V7.67834C21.3214 8.15173 20.9376 8.53549 20.4643 8.53549H18.0535V10.9461C18.0535 11.4195 17.6698 11.8033 17.1963 11.8033H14.4107C13.9373 11.8033 13.5536 11.4195 13.5536 10.9461V8.53549H11.1429C10.6695 8.53549 10.2857 8.15173 10.2857 7.67834V4.89263C10.2857 4.41923 10.6695 4.03549 11.1429 4.03549H13.5536V1.62472ZM3.15969 10.9997H0V17.8569L3.13445 20.9913C4.42041 22.2773 6.16455 22.9997 7.98317 22.9997H18C19.4201 22.9997 20.5714 21.8484 20.5714 20.4283C20.5714 19.0082 19.4201 17.8569 18 17.8569H13.2397C13.0742 18.4166 12.7706 18.9441 12.3289 19.3857C10.9164 20.7982 8.62627 20.7982 7.21375 19.3857L4.72802 16.9C4.30959 16.4815 4.30959 15.8032 4.72802 15.3848C5.14644 14.9663 5.82483 14.9663 6.24324 15.3848L8.72899 17.8704C9.30466 18.4462 10.238 18.4462 10.8137 17.8704C11.3314 17.3529 11.3836 16.5458 10.9701 15.9698L8.00841 13.0081C6.72245 11.7222 4.9783 10.9997 3.15969 10.9997Z",
        width: "22",
        height: "23",
        route: "/orders",
      },
      {
        name: "Документы",
        path: "M10.503 1.37962C10.0388 1.02682 9.46855 0.842336 8.88591 0.856196H2.57143C1.88945 0.856196 1.23539 1.12711 0.753154 1.60935C0.270917 2.09159 0 2.74564 0 3.42763V20.5704C0 21.2525 0.270917 21.9065 0.753154 22.3888C1.23539 22.871 1.88943 23.1418 2.57143 23.1418H21.4286C22.1105 23.1418 22.7647 22.871 23.2469 22.3888C23.7291 21.9065 24 21.2525 24 20.5704V6.8562C24 6.17421 23.7291 5.52016 23.2469 5.03793C22.7647 4.55568 22.1105 4.28478 21.4286 4.28478H11.8121L11.4436 2.81085C11.3026 2.24087 10.9705 1.73493 10.503 1.37962Z",
        width: "24",
        height: "24",
        route: "/docs",
      },
      {
        name: "Сотрудники",
        path: "M13.7143 5.71512C13.7143 8.55544 11.4117 10.858 8.57143 10.858C5.73111 10.858 3.42857 8.55544 3.42857 5.71512C3.42857 2.87481 5.73111 0.572266 8.57143 0.572266C11.4117 0.572266 13.7143 2.87481 13.7143 5.71512ZM8.57143 12.5722C3.83757 12.5722 0 16.4098 0 21.1436C0 21.617 0.383757 22.0008 0.857143 22.0008H16.2857C16.7591 22.0008 17.1429 21.617 17.1429 21.1436C17.1429 16.4098 13.3053 12.5722 8.57143 12.5722ZM23.143 22.0008H19.1616C19.2425 21.7292 19.2859 21.4414 19.2859 21.1436C19.2859 17.6446 17.6086 14.5374 15.0143 12.5821C15.1516 12.5755 15.2898 12.5722 15.4287 12.5722C20.1626 12.5722 24.0002 16.4098 24.0002 21.1436C24.0002 21.617 23.6163 22.0008 23.143 22.0008ZM15.4287 10.858C14.9115 10.858 14.4121 10.7816 13.9411 10.6395C15.131 9.34281 15.8573 7.61378 15.8573 5.71512C15.8573 3.81647 15.131 2.08744 13.9411 0.790683C14.4121 0.64862 14.9115 0.572266 15.4287 0.572266C18.269 0.572266 20.5716 2.87481 20.5716 5.71512C20.5716 8.55544 18.269 10.858 15.4287 10.858Z",
        width: "24",
        height: "22",
        route: "/members",
      },
      {
        name: "История записи",
        path: "M12 24C18.6274 24 24 18.6274 24 12C24 5.37259 18.6274 0 12 0C5.37259 0 0 5.37259 0 12C0 18.6274 5.37259 24 12 24ZM13.0714 7.71429C13.0714 7.12255 12.5917 6.64286 12 6.64286C11.4083 6.64286 10.9286 7.12255 10.9286 7.71429V12C10.9286 12.2506 11.0164 12.4934 11.1769 12.6859L15.4626 17.8287C15.8414 18.2834 16.517 18.3447 16.9716 17.9659C17.4262 17.5872 17.4876 16.9115 17.1088 16.4569L13.0714 11.6121V7.71429Z",
        width: "24",
        height: "24",
        route: "/history",
      },
      {
        name: "Тех. поддержка",
        path: "M11.9777 2.57234C11.2611 2.5594 10.5489 2.6879 9.88202 2.9505C9.21511 3.2131 8.60653 3.60463 8.09111 4.1027C7.57569 4.60076 7.16355 5.19558 6.87827 5.85311C6.59299 6.51064 6.44017 7.21797 6.42857 7.93463V15.4295C6.42857 15.6546 6.38423 15.8775 6.29808 16.0855C6.21193 16.2935 6.08565 16.4825 5.92647 16.6417C5.76728 16.8009 5.5783 16.9271 5.37031 17.0133C5.16233 17.0994 4.93941 17.1438 4.71429 17.1438H2.57143C1.88944 17.1438 1.23539 16.8729 0.753154 16.3906C0.270918 15.9084 0 15.2543 0 14.5723L0 11.1438C0 10.4618 0.270918 9.80773 0.753154 9.32549C1.23539 8.84326 1.88944 8.57234 2.57143 8.57234H3.85714V7.90377C3.87278 6.85016 4.09583 5.80995 4.51353 4.84255C4.93124 3.87514 5.53542 2.9995 6.29158 2.26563C7.04774 1.53176 7.94105 0.954035 8.92052 0.56545C9.89998 0.176866 10.9464 -0.0149662 12 0.000910824C13.0536 -0.0149662 14.1 0.176866 15.0795 0.56545C16.0589 0.954035 16.9523 1.53176 17.7084 2.26563C18.4646 2.9995 19.0688 3.87514 19.4865 4.84255C19.9042 5.80995 20.1272 6.85016 20.1429 7.90377V7.92091V8.57234H21.4286C21.7663 8.57234 22.1006 8.63885 22.4126 8.76808C22.7246 8.8973 23.0081 9.08671 23.2468 9.32549C23.4856 9.56427 23.675 9.84775 23.8043 10.1597C23.9335 10.4717 24 10.8061 24 11.1438V14.5723C24 15.2543 23.7291 15.9084 23.2468 16.3906C22.7646 16.8729 22.1106 17.1438 21.4286 17.1438H20.1429V18.0009C20.1431 19.1594 19.7168 20.2773 18.9452 21.1415C18.1737 22.0056 17.1111 22.5555 15.96 22.6861C15.7365 23.0852 15.4105 23.4174 15.0158 23.6485C14.621 23.8797 14.1717 24.0013 13.7143 24.0009H11.1429C10.4609 24.0009 9.80682 23.73 9.32458 23.2478C8.84235 22.7655 8.57143 22.1115 8.57143 21.4295C8.57143 20.7475 8.84235 20.0934 9.32458 19.6112C9.80682 19.129 10.4609 18.8581 11.1429 18.8581H13.7143C14.6434 18.8581 15.4577 19.3501 15.9086 20.0889C16.3811 19.9803 16.8028 19.7147 17.1048 19.3354C17.4068 18.9562 17.5713 18.4857 17.5714 18.0009V7.93291C17.5597 7.21257 17.4052 6.5017 17.1171 5.8414C16.8289 5.1811 16.4127 4.58447 15.8926 4.086C15.3724 3.58753 14.7586 3.1971 14.0867 2.93729C13.4147 2.67748 12.6979 2.55344 11.9777 2.57234Z",
        width: "24",
        height: "24",
        route: "/support",
      },
      {
        name: "О программе",
        path: "M12 24C18.6274 24 24 18.6274 24 12C24 5.37259 18.6274 0 12 0C5.37259 0 0 5.37259 0 12C0 18.6274 5.37259 24 12 24ZM9.42857 16.0714C8.83683 16.0714 8.35714 16.5511 8.35714 17.1429C8.35714 17.7346 8.83683 18.2143 9.42857 18.2143H14.5714C15.1632 18.2143 15.6429 17.7346 15.6429 17.1429C15.6429 16.5511 15.1632 16.0714 14.5714 16.0714H13.0714V11.1429C13.0714 10.5511 12.5917 10.0714 12 10.0714H10.2857C9.69398 10.0714 9.21429 10.5511 9.21429 11.1429C9.21429 11.7346 9.69398 12.2143 10.2857 12.2143H10.9286V16.0714H9.42857ZM13.7143 6.85714C13.7143 7.80391 12.9468 8.57143 12 8.57143C11.0532 8.57143 10.2857 7.80391 10.2857 6.85714C10.2857 5.91038 11.0532 5.14286 12 5.14286C12.9468 5.14286 13.7143 5.91038 13.7143 6.85714Z",
        width: "24",
        height: "24",
        route: "/info",
      },
    ],
  }),
  directives: {
    clickOutside: vClickOutside.directive,
  },
  watch: {
    windowWidth() {
      if(this.windowWidth < 640){
        this.menuWrapp = false;
      }
    },
  },
  computed: {
    filterMobileMenu() {
      return this.menuItems.filter((item, idx) => {
        return idx !== 3 && idx < 5;
      });
    },
    filterMoreMenu() {
      return this.menuItems.filter((item, idx) => {
        return idx !== 0 && idx !== 1 && idx !== 2 && idx !== 4 && idx !== 5;
      });
    },
    menuWrapp(){
      return getters.menuWrapp()
    }
  },
  methods: {
    onClickOutside() {
      this.moreMenuMobileshow = false;
    },
    toggleMenu(){
      mutations.togglemenuWrapped();
    }
  },
  mounted() {
    window.onresize = () => {
      this.windowWidth = window.innerWidth;
    };
  },
};
</script>
